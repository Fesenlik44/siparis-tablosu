<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Google Sheets Sipariş Tablosu</title>
</head>
<body>
  <h1>📋 Sipariş Listesi</h1>
  <div id="liste"></div>

  <h2>➕ Yeni Sipariş Ekle</h2>
  <input type="text" id="isim" placeholder="İsim">
  <input type="text" id="email" placeholder="E-posta">
  <button onclick="veriEkle()">Ekle</button>

  <script>
    const sheetURL = "https://script.google.com/macros/s/AKfycbzT8U5MHI9eTEPHQ1DDhXUlwDToj3WObde_Z2eWRnt1/dev";

    // Verileri listele
    fetch(sheetURL)
      .then(res => res.json())
      .then(data => {
        const liste = document.getElementById('liste');
        if (data.length === 0) {
          liste.innerHTML = "<p>Veri bulunamadı.</p>";
          return;
        }

        // İlk satırı başlık olarak atla (isteğe bağlı)
        data.slice(1).forEach(row => {
          const satir = document.createElement('p');
          satir.textContent = row.join(" | ");
          liste.appendChild(satir);
        });
      })
      .catch(err => {
        console.error("Hata:", err);
        document.getElementById('liste').innerHTML = "<p>Veri alınamadı.</p>";
      });

    // Yeni veri ekle
    function veriEkle() {
      const isim = document.getElementById('isim').value;
      const email = document.getElementById('email').value;

      if (!isim || !email) {
        alert("Lütfen tüm alanları doldurun.");
        return;
      }

      fetch(sheetURL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ name: isim, email: email })
      })
      .then(res => res.text())
      .then(msg => {
        alert("Ekleme başarılı: " + msg);
        location.reload();
      })
      .catch(err => {
        console.error("Ekleme hatası:", err);
        alert("Veri eklenemedi.");
      });
    }
  </script>
</body>
</html>
